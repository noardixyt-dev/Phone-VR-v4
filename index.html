<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stereo Camera + Menu</title>
<style>
  html, body { margin:0; padding:0; height:100%; overflow:hidden; background:#000; font-family:system-ui; color:#fff; }
  #overlay { position:absolute; inset:0; display:flex; justify-content:center; align-items:center; background:rgba(0,0,0,0.85); font-size:20px; text-align:center; padding:20px; z-index:10; display:none;}
  .eye { position:absolute; top:0; width:50%; height:100%; background:#000; overflow:hidden; }
  #leftEye { left:0; }
  #rightEye { right:0; }
  #menu { position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); padding:20px 30px; background:rgba(0,127,255,0.8); border-radius:10px; display:none; z-index:5; }
  #fullscreenBtn { position:absolute; top:10px; right:10px; padding:8px 12px; background:rgba(255,255,255,0.1); border-radius:6px; cursor:pointer; z-index:5; }
</style>
</head>
<body>

<div id="overlay">Please rotate your device to landscape and grant camera & motion permission</div>
<div id="leftEye" class="eye"><video id="videoLeft" autoplay muted playsinline></video></div>
<div id="rightEye" class="eye"><video id="videoRight" autoplay muted playsinline></video></div>
<div id="menu">Stereo Menu (clickable)</div>
<div id="fullscreenBtn">Fullscreen</div>

<script>
const overlay = document.getElementById('overlay');
const leftEye = document.getElementById('leftEye');
const rightEye = document.getElementById('rightEye');
const videoLeft = document.getElementById('videoLeft');
const videoRight = document.getElementById('videoRight');
const menu = document.getElementById('menu');
const fullscreenBtn = document.getElementById('fullscreenBtn');

let menuVisible = false;
let hideMenuTimer = null;

// Check landscape orientation
function checkOrientation() {
  const isLandscape = window.innerWidth >= window.innerHeight;
  overlay.style.display = isLandscape ? 'none' : 'flex';
  leftEye.style.display = rightEye.style.display = isLandscape ? 'block' : 'none';
}
window.addEventListener('resize', checkOrientation);
checkOrientation();

// Camera setup
async function initCamera() {
  try {
    const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode:'environment' }, audio: false });
    videoLeft.srcObject = stream;
    videoRight.srcObject = stream;
  } catch(e) {
    overlay.style.display = 'flex';
    overlay.textContent = 'Camera access denied';
  }
}
initCamera();

// Double-tap to toggle menu
let lastTap = 0;
window.addEventListener('pointerdown', () => {
  const now = Date.now();
  if(now - lastTap < 300){
    menuVisible = !menuVisible;
    menu.style.display = menuVisible ? 'block' : 'none';
    if(menuVisible){
      // hide automatically after 10s
      if(hideMenuTimer) clearTimeout(hideMenuTimer);
      hideMenuTimer = setTimeout(()=>{ menu.style.display='none'; menuVisible=false; }, 10000);
    }
  }
  lastTap = now;
});

// Fullscreen toggle
fullscreenBtn.addEventListener('click', async ()=>{
  try{
    if(!document.fullscreenElement) await document.documentElement.requestFullscreen();
    else await document.exitFullscreen();
  } catch(e){ console.warn("Fullscreen failed", e); }
});
</script>
</body>
</html>
