<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Camera Fullscreen Test</title>
<style>
html,body{margin:0;height:100%;background:#000;overflow:hidden}
#start{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
  padding:14px 22px;border-radius:10px;border:none;
  background:#007bff;color:#fff;font-size:16px}
video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;}
</style>
</head>
<body>
<button id="start">Start Camera</button>
<video id="video" playsinline autoplay muted></video>

<script>
const btn = document.getElementById('start');
const video = document.getElementById('video');

btn.addEventListener('click', async () => {
  try {
    // 1️⃣ Fullscreen must be requested first & sync with gesture
    if (document.documentElement.requestFullscreen) {
      await document.documentElement.requestFullscreen();
    }

    // 2️⃣ Ask for camera AFTER fullscreen
    const devices = await navigator.mediaDevices.enumerateDevices();
    const vids = devices.filter(d => d.kind === 'videoinput');
    let deviceId = null;
    for (const k of ['back','rear','environment','main','wide']) {
      const found = vids.find(v => v.label && v.label.toLowerCase().includes(k));
      if (found) { deviceId = found.deviceId; break; }
    }
    const constraints = deviceId
      ? { video:{deviceId:{exact:deviceId}}, audio:false }
      : { video:{facingMode:{ideal:'environment'}}, audio:false };

    const stream = await navigator.mediaDevices.getUserMedia(constraints);
    video.srcObject = stream;
    btn.style.display='none';
  } catch(err){
    alert('Camera start failed: ' + err.message);
  }
});
</script>
</body>
</html>
